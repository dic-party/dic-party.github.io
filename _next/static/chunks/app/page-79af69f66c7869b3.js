(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{864:function(e,s,t){Promise.resolve().then(t.bind(t,3980))},3980:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return P}});var n=t(9268),a=t(6006);function r(e){let[s,t]=(0,a.useState)(""),r=t=>{t.preventDefault(),e.onSubmit(s)};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h1",{className:"font-serif text-peach text-4xl",children:"Welcome back, friend."}),(0,n.jsx)("p",{className:"font-serif text-lg",children:"Enter your password to access the DiC party suite doorbell."}),(0,n.jsxs)("form",{className:"flex flex-col gap-4",children:[(0,n.jsx)("input",{type:"password",autoFocus:!0,onChange:e=>t(e.target.value),placeholder:"You remember it, right?",className:"bg-transparent border-0 border-b-2 border-b-periwinkle focus:border-b-mint !outline-none font-sans pb-1"}),(0,n.jsx)("input",{type:"submit",value:"",onClick:e=>r(e)})]})]})}var l=t(1410),i=t(9),o=t(278),c=t(3603),d=t(3516),u=t(7215);let h={dcpurple:"#686e9f",dcblue:"#86c8bc",dcyellow:"#eada24",dcorange:"#ffa38b"};function x(e){let s=null;return s=e.loading?(0,n.jsx)(o.ZP,{color:"currentColor",size:"sm"}):"Ding Dong",(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)(c.Z,{color:h.dcblue,children:["username> ",e.userInfo.username]}),(0,n.jsxs)(c.Z,{color:e.userInfo.banned?h.dcorange:h.dcblue,children:["status> ",e.userInfo.banned?"banned":"active"]}),(0,n.jsxs)(c.Z,{color:h.dcyellow,children:["party location> ",e.partyInfo]})]}),(0,n.jsx)(d.Z,{}),(0,n.jsx)(u.ZP,{bordered:!0,size:"xl",css:{color:h.dcpurple,borderColor:h.dcpurple},disabled:!!e.disabled||!!e.userInfo.banned,onPress:e.onSubmit,children:s})]})}l.vI.add(i.qmU),l.vI.add(i.bE7);var m=t(9916);function p(e){let[s,t]=(0,a.useState)(""),[r,l]=(0,a.useState)(""),[i,o]=(0,a.useState)(!1),c=t=>{t.preventDefault(),s&&r&&!i&&e.onSubmit(s,r)};return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("form",{className:"flex flex-col gap-4",children:[(0,n.jsx)("h1",{className:"font-serif text-peach text-4xl",children:"Register"}),i?(0,n.jsx)("b",{children:"Invalid character in password (:)"}):"",(0,n.jsx)(m.ZP,{labelPlaceholder:"username",onChange:e=>{t(e.target.value)}}),(0,n.jsx)(d.Z,{y:1}),(0,n.jsx)(m.ZP.Password,{labelPlaceholder:"password",onChange:e=>{let s=e.target.value;if(l(s),-1!==s.indexOf(":")){o(!0);return}o(!1)}}),(0,n.jsx)("input",{type:"submit",value:"",onClick:e=>c(e)})]})})}l.vI.add(i.qmU),l.vI.add(i.bE7);var f=t(1917),j=t(3285),b=t(2268);l.vI.add(i.qmU),l.vI.add(i.bE7);let w="https://7mg5vpebc4.execute-api.us-west-2.amazonaws.com";function g(e){var s;let[t,r]=(0,a.useState)([]),[l,i]=(0,a.useState)([]),[u,x]=(0,a.useState)(!1),[m,p]=(0,a.useState)(""),g=async()=>{let s=new Headers;s.append("Authorization","Basic "+(0,b.encode)(e.uid+":"+e.password));let t=await fetch(w+"/user/",{method:"GET",headers:s});200===t.status&&r((await t.json()).users)},Z=async()=>{let s=Math.round(Date.now()/1e3-600),t=new Headers;t.append("Authorization","Basic "+(0,b.encode)(e.uid+":"+e.password));let n=await fetch(w+"/ring/"+s,{method:"GET",headers:t});200===n.status&&i((await n.json()).rings)},P=async s=>{let t=new Headers;t.append("Authorization","Basic "+(0,b.encode)(e.uid+":"+e.password)),await fetch(w+"/user/"+s.id,{method:"POST",headers:t,body:JSON.stringify(s)}),g()},y=async s=>{s.preventDefault();let t=new Headers;t.append("Authorization","Basic "+(0,b.encode)(e.uid+":"+e.password)),await fetch(w+"/announce/party",{method:"POST",headers:t,body:JSON.stringify({text:m})})};if((0,a.useEffect)(()=>{g(),Z(),setInterval(Z,5e3)},[]),!(null===(s=e.userInfo)||void 0===s?void 0:s.admin))return;let v=(0,n.jsx)(o.ZP,{}),S={backgroundColor:"transparent",color:"white"};t.length>0&&(v=(0,n.jsxs)(f.ZP,{"aria-label":"User admin table",css:{height:"auto",width:"100%"},children:[(0,n.jsxs)(f.ZP.Header,{children:[(0,n.jsx)(f.ZP.Column,{css:S,children:"UID"}),(0,n.jsx)(f.ZP.Column,{css:S,children:"Username"}),(0,n.jsx)(f.ZP.Column,{css:S,children:"Banned"}),(0,n.jsx)(f.ZP.Column,{css:S,children:"Admin"})]}),(0,n.jsx)(f.ZP.Body,{children:t.map(e=>(0,n.jsxs)(f.ZP.Row,{css:{color:h.dcblue,textAlign:"left"},children:[(0,n.jsx)(f.ZP.Cell,{children:e.id}),(0,n.jsx)(f.ZP.Cell,{children:e.username}),(0,n.jsx)(f.ZP.Cell,{children:(0,n.jsx)(j.ZP,{checked:e.banned,onChange:s=>{P({...e,banned:s.target.checked})}})}),(0,n.jsx)(f.ZP.Cell,{children:(0,n.jsx)(j.ZP,{checked:e.admin,onChange:s=>{P({...e,admin:s.target.checked})}})})]},e.id))})]}));let C=(0,n.jsx)(o.ZP,{});return l.length>0&&(C=(0,n.jsxs)(f.ZP,{"aria-label":"Ring log",children:[(0,n.jsxs)(f.ZP.Header,{children:[(0,n.jsx)(f.ZP.Column,{css:S,children:"UID"}),(0,n.jsx)(f.ZP.Column,{css:S,children:"Timestamp"})]}),(0,n.jsx)(f.ZP.Body,{children:l.map(e=>(0,n.jsxs)(f.ZP.Row,{css:{color:h.dcblue,textAlign:"left"},children:[(0,n.jsx)(f.ZP.Cell,{children:e.uid}),(0,n.jsx)(f.ZP.Cell,{children:new Date(1e3*parseInt(e.timestamp)).toLocaleString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"})})]},e.timestamp+e.uid))})]})),(0,n.jsxs)("div",{className:"flex flex-col gap-1 text-center",children:[(0,n.jsx)(d.Z,{}),(0,n.jsx)("div",{children:(0,n.jsxs)("form",{children:[(0,n.jsx)("input",{placeholder:"set party details (default 'TBA')",className:"rounded-md bg-transparent border-0 border-b-2 border-b-periwinkle focus:border-b-mint !outline-none pb-1",onChange:e=>p(e.target.value)}),(0,n.jsx)("input",{type:"submit",value:"",onClick:e=>y(e)})]})}),(0,n.jsx)(d.Z,{}),(0,n.jsx)(c.Z,{h1:!0,color:h.dcpurple,className:"text-3xl font-bold",children:"Users"}),v,(0,n.jsx)(d.Z,{}),(0,n.jsx)(c.Z,{h2:!0,color:h.dcpurple,className:"text-3xl font-bold",children:"Rings"}),C]})}let Z="https://7mg5vpebc4.execute-api.us-west-2.amazonaws.com";function P(){let[e,s]=(0,a.useState)(""),[t,l]=(0,a.useState)(!1),[i,o]=(0,a.useState)(!1),[c,u]=(0,a.useState)(""),[h,m]=(0,a.useState)(null),[f,j]=(0,a.useState)(!1),[w,P]=(0,a.useState)(!1),[y,v]=(0,a.useState)("");(0,a.useEffect)(()=>{let s=async()=>{let s=new URL(document.location.href).searchParams.get("id");if(""===c&&s&&u(s),t||i)return;let n=new Headers;n.append("Authorization","Basic "+(0,b.encode)(c+":"+e));let a=await fetch(Z+"/user/"+c,{method:"GET",headers:n});switch(a.status){case 204:o(!0);break;case 200:await m(await a.json()),await l(!0),setInterval(S,2e3)}};s()});let S=async()=>{let s=new Headers;s.append("Authorization","Basic "+(0,b.encode)(c+":"+e));let t=await fetch(Z+"/announce/party",{method:"GET",headers:s});if(200!==t.status){console.log("Something went wrong fetching party details");return}let n=await t.json();await v(n.text)},C=async(e,s)=>{let t=new Headers,n=await fetch(Z+"/user/"+c,{method:"POST",headers:t,body:JSON.stringify({username:e,password:s})});if(200!==n.status){console.log("something went wrong"),console.log(await n.json());return}o(!1)},I=async()=>{j(!0);let s=new Headers;s.append("Authorization","Basic "+(0,b.encode)(c+":"+e)),await fetch(Z+"/ring",{method:"POST",headers:s}),j(!1),P(!0),setTimeout(()=>{P(!1)},3e4)};return t||i?t?(0,n.jsxs)("main",{className:"flex min-h-screen flex-col items-center justify-between p-24",children:[(0,n.jsx)(x,{loading:f,disabled:w,userInfo:h,onSubmit:I,partyInfo:y}),(0,n.jsx)(d.Z,{}),(0,n.jsx)(g,{userInfo:h,uid:c,password:e})]}):i?(0,n.jsx)("main",{className:"flex min-h-screen flex-col items-center justify-between p-24",children:(0,n.jsx)(p,{onSubmit:C})}):(0,n.jsx)("main",{className:"flex min-h-screen flex-col items-center justify-between p-24"}):(0,n.jsx)("main",{className:"flex min-h-screen flex-col justify-center mx-auto p-12 gap-6 max-w-prose",children:(0,n.jsx)(r,{onSubmit:e=>{s(e)}})})}}},function(e){e.O(0,[957,922,253,769,744],function(){return e(e.s=864)}),_N_E=e.O()}]);