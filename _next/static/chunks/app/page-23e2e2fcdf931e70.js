(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{864:function(e,s,t){Promise.resolve().then(t.bind(t,3980))},3980:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return P}});var n=t(9268),a=t(6006);function r(e){let[s,t]=(0,a.useState)(""),r=t=>{t.preventDefault(),e.onSubmit(s)};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h1",{className:"font-serif text-peach text-4xl",children:"Welcome back, friend."}),(0,n.jsx)("p",{className:"font-serif text-lg",children:"Enter your password to access the DiC party suite doorbell."}),(0,n.jsxs)("form",{className:"flex flex-col gap-4",children:[(0,n.jsx)("input",{type:"password",onChange:e=>t(e.target.value),placeholder:"You remember it, right?",className:"bg-transparent border-0 border-b-2 border-b-periwinkle focus:border-b-mint !outline-none font-sans pb-1"}),(0,n.jsx)("input",{type:"submit",value:"",onClick:e=>r(e)})]})]})}var l=t(1410),i=t(9),d=t(278),o=t(3603),c=t(3516),u=t(7215);let h={dcpurple:"#686e9f",dcblue:"#86c8bc",dcyellow:"#eada24",dcorange:"#ffa38b"};function x(e){let s=null;return s=e.loading?(0,n.jsx)(d.ZP,{color:"currentColor",size:"sm"}):"Ding Dong",(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)(o.Z,{color:h.dcblue,children:["username> ",e.userInfo.username]}),(0,n.jsxs)(o.Z,{color:e.userInfo.banned?h.dcorange:h.dcblue,children:["status> ",e.userInfo.banned?"banned":"active"]}),(0,n.jsxs)(o.Z,{color:h.dcyellow,children:["party location> ",e.partyInfo]})]}),(0,n.jsx)(c.Z,{}),(0,n.jsx)(u.ZP,{bordered:!0,size:"xl",css:{color:h.dcpurple,borderColor:h.dcpurple},disabled:!!e.disabled||!!e.userInfo.banned,onPress:e.onSubmit,children:s})]})}l.vI.add(i.qmU),l.vI.add(i.bE7);var m=t(9916);function f(e){let[s,t]=(0,a.useState)(""),[r,l]=(0,a.useState)(""),[i,d]=(0,a.useState)(!1),o=t=>{t.preventDefault(),s&&r&&!i&&e.onSubmit(s,r)};return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("form",{className:"flex flex-col gap-4",children:[(0,n.jsx)("h1",{className:"font-serif text-peach text-4xl",children:"Register"}),i?(0,n.jsx)("b",{children:"Invalid character in password (:)"}):"",(0,n.jsx)(m.ZP,{labelPlaceholder:"username",onChange:e=>{t(e.target.value)}}),(0,n.jsx)(c.Z,{y:1}),(0,n.jsx)(m.ZP.Password,{labelPlaceholder:"password",onChange:e=>{let s=e.target.value;if(l(s),-1!==s.indexOf(":")){d(!0);return}d(!1)}}),(0,n.jsx)("input",{type:"submit",value:"",onClick:e=>o(e)})]})})}l.vI.add(i.qmU),l.vI.add(i.bE7);var p=t(1917),j=t(3285),b=t(2268);l.vI.add(i.qmU),l.vI.add(i.bE7);let w="https://7mg5vpebc4.execute-api.us-west-2.amazonaws.com";function g(e){var s;let[t,r]=(0,a.useState)([]),[l,i]=(0,a.useState)([]),[u,x]=(0,a.useState)(!1),m=async()=>{let s=new Headers;s.append("Authorization","Basic "+(0,b.encode)(e.uid+":"+e.password));let t=await fetch(w+"/user/",{method:"GET",headers:s});200===t.status&&r((await t.json()).users)},f=async()=>{let s=Math.round(Date.now()/1e3-300),t=new Headers;t.append("Authorization","Basic "+(0,b.encode)(e.uid+":"+e.password));let n=await fetch(w+"/ring/"+s,{method:"GET",headers:t});200===n.status&&i((await n.json()).rings)},g=async s=>{let t=new Headers;t.append("Authorization","Basic "+(0,b.encode)(e.uid+":"+e.password)),await fetch(w+"/user/"+s.id,{method:"POST",headers:t,body:JSON.stringify(s)}),m()};if((0,a.useEffect)(()=>{m(),f()},[]),!(null===(s=e.userInfo)||void 0===s?void 0:s.admin))return;let Z=(0,n.jsx)(d.ZP,{});t.length>0&&(Z=(0,n.jsxs)(p.ZP,{striped:!0,sticked:!0,bordered:!0,"aria-label":"User admin table",css:{height:"auto",width:"100%"},children:[(0,n.jsxs)(p.ZP.Header,{children:[(0,n.jsx)(p.ZP.Column,{children:"UID"}),(0,n.jsx)(p.ZP.Column,{children:"Username"}),(0,n.jsx)(p.ZP.Column,{children:"Banned"})]}),(0,n.jsx)(p.ZP.Body,{children:t.map(e=>(0,n.jsxs)(p.ZP.Row,{children:[(0,n.jsx)(p.ZP.Cell,{children:e.id}),(0,n.jsx)(p.ZP.Cell,{children:e.username}),(0,n.jsx)(p.ZP.Cell,{children:(0,n.jsx)(j.ZP,{checked:e.banned,onChange:s=>{g({...e,banned:s.checked})}})})]},e.id))})]}));let P=(0,n.jsx)(d.ZP,{});return l.length>0&&(P=(0,n.jsxs)(p.ZP,{sticked:!0,bordered:!0,"aria-label":"Ring log",children:[(0,n.jsxs)(p.ZP.Header,{children:[(0,n.jsx)(p.ZP.Column,{children:"UID"}),(0,n.jsx)(p.ZP.Column,{children:"Timestamp"}),(0,n.jsx)(p.ZP.Column,{children:"Valid"})]}),(0,n.jsx)(p.ZP.Body,{children:l.map(e=>(0,n.jsxs)(p.ZP.Row,{children:[(0,n.jsx)(p.ZP.Cell,{children:e.uid}),(0,n.jsx)(p.ZP.Cell,{children:new Date(1e3*parseInt(e.timestamp)).toLocaleString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"})}),(0,n.jsx)(p.ZP.Cell,{children:e.valid})]},e.timestamp+e.uid))})]})),(0,n.jsxs)("div",{className:"flex flex-col gap-1 text-center",children:[(0,n.jsx)(c.Z,{}),(0,n.jsx)("div",{children:(0,n.jsxs)("form",{children:[(0,n.jsx)("input",{placeholder:"set party details (default '???')",className:"rounded-md"}),(0,n.jsx)("input",{type:"submit",value:""})]})}),(0,n.jsx)(c.Z,{}),(0,n.jsx)(o.Z,{h1:!0,color:h.dcpurple,className:"text-3xl font-bold",children:"Users"}),Z,(0,n.jsx)(o.Z,{h2:!0,color:h.dcpurple,className:"text-3xl font-bold",children:"Rings"}),P]})}let Z="https://7mg5vpebc4.execute-api.us-west-2.amazonaws.com";function P(){let[e,s]=(0,a.useState)(""),[t,l]=(0,a.useState)(!1),[i,d]=(0,a.useState)(!1),[o,u]=(0,a.useState)(""),[h,m]=(0,a.useState)(null),[p,j]=(0,a.useState)(!1),[w,P]=(0,a.useState)(!1);(0,a.useEffect)(()=>{let s=async()=>{let s=new URL(document.location.href).searchParams.get("id");if(""===o&&s&&u(s),t||i)return;let n=new Headers;n.append("Authorization","Basic "+(0,b.encode)(o+":"+e));let a=await fetch(Z+"/user/"+o,{method:"GET",headers:n});switch(a.status){case 204:d(!0);case 200:await m(await a.json()),await l(!0)}};s()});let v=async(e,s)=>{let t=new Headers,n=await fetch(Z+"/user/"+o,{method:"POST",headers:t,body:JSON.stringify({username:e,password:s})});if(200!==n.status){console.log("something went wrong"),console.log(await n.json());return}d(!1)},y=async()=>{j(!0);let s=new Headers;s.append("Authorization","Basic "+(0,b.encode)(o+":"+e)),await fetch(Z+"/ring",{method:"POST",headers:s}),j(!1),P(!0),setTimeout(()=>{P(!1)},3e4)};return t||i?t?(0,n.jsxs)("main",{className:"flex min-h-screen flex-col items-center justify-between p-24",children:[(0,n.jsx)(x,{loading:p,disabled:w,userInfo:h,onSubmit:y,partyInfo:""}),(0,n.jsx)(c.Z,{}),(0,n.jsx)(g,{userInfo:h,uid:o,password:e})]}):i?(0,n.jsx)("main",{className:"flex min-h-screen flex-col items-center justify-between p-24",children:(0,n.jsx)(f,{onSubmit:v})}):(0,n.jsx)("main",{className:"flex min-h-screen flex-col items-center justify-between p-24"}):(0,n.jsx)("main",{className:"flex min-h-screen flex-col justify-center mx-auto p-12 gap-6 max-w-prose",children:(0,n.jsx)(r,{onSubmit:e=>{s(e)}})})}}},function(e){e.O(0,[957,922,253,769,744],function(){return e(e.s=864)}),_N_E=e.O()}]);